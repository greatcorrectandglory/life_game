# 反脆弱人生 RPG (Antifragile Life RPG)

> "风会熄灭蜡烛，却能使火越烧越旺。" —— 纳西姆·塔勒布

基于非线性收益与动态不确定性的高保真人生模拟系统。本项目旨在构建一个数学上严谨的人生模拟器，验证核心生存哲学：**主动挑战随机性、构建反脆弱结构，是应对不确定未来的最优解**。

## 🚀 项目现状 (v1.1.0)

本项目已完成核心重构，从单文件脚本升级为模块化架构，并引入了深度叙事系统。

### 主要更新
- **架构重构**: 完整的模块化设计 (`core`, `systems`, `ui`, `data`)。
- **深度叙事**: 全新的剧情链系统，包含 7 个人生阶段、42+ 情感剧情点。
- **数据驱动**: 所有配置（任务、技能、事件）均已提取为独立数据文件。
- **状态管理**: 实现了高性能的响应式状态管理系统。

## ✨ 核心特性

### 1. 深度叙事系统 (New!)
- **全生命周期剧情**: 从小学到晚年的 7 个阶段，每个阶段都有独特的主题和情感弧线。
- **42+ 剧情节点**: 不仅仅是数值变化，更是具体的生活场景（如"高考前的焦虑"、"深夜加班的疲惫"）。
- **情感共鸣**: 剧情触发与心理状态（压力、情绪）紧密耦合。

### 2. 认知吸收率矩阵
- **低熵活动**: 快速恢复情绪，但技能成长慢。
- **高熵活动**: 高压力、高收益，构建深度思维模型。
- **艾宾浩斯衰减**: 模拟真实记忆遗忘，鼓励持续刻意练习。

### 3. 反脆弱经济系统
- **动态职业生涯**: 行业有萌芽、成长、衰退周期。
- **黑天鹅事件**: 随机的极端冲击（失业、生病、暴富），检验系统的反脆弱性。
- **杠铃策略**: 鼓励玩家在"极度保守"和"极度冒险"之间分配资源，避免平庸的陷阱。

### 4. 完善的存档系统
- 支持手动/自动存档。
- 本地持久化存储 (LocalStorage)。
- 完整的存档元数据管理。

## 🛠️ 项目结构

```
src/
├── core/              # 核心引擎
│   ├── gameLoop.js    # 主循环与时间控制
│   ├── state.js       # 响应式状态管理
│   └── ...
├── systems/           # 游戏子系统
│   ├── cognitive.js   # 认知与学习系统
│   ├── economy.js     # 经济与职业系统
│   ├── events.js      # 事件与黑天鹅系统
│   └── skills.js      # 技能与成长系统
├── data/              # 游戏数据配置
│   ├── quests.js      # 任务与剧情链
│   ├── actions.js     # 玩家行动定义
│   ├── events.js      # 随机事件库
│   └── ...
├── ui/                # 界面组件
│   ├── components/    # 独立 UI 组件
│   └── render.js      # 视图渲染器
└── utils/             # 工具库
    ├── saveSystem.js  # 存档管理
    └── logger.js      # 日志系统
```

## 🏁 快速开始

### 安装依赖

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```
访问 http://localhost:3000

### 其他命令

```bash
npm run build      # 构建生产版本
npm run test       # 运行测试
npm run lint:fix   # 代码格式化与修复
```

## 🗺️ 开发路线图

### 已完成 ✅
- [x] **核心重构**: 模块化架构拆分
- [x] **数据分离**: 配置与逻辑解耦
- [x] **叙事升级**: 剧情链系统 (Story Chains)
- [x] **基础设施**: 存档系统、日志系统、状态管理
- [x] **核心机制**: 认知吸收率、艾宾浩斯衰减

### 进行中 🚧
- [ ] **UI 交互优化**: 更加现代化的界面反馈
- [ ] **视觉增强**: 关键剧情点的视觉特效
- [ ] **移动端适配**: 响应式布局优化

### 计划中 📋
- [ ] **AI 导演 v2**: 基于玩家行为动态调整难度
- [ ] **人际关系网**: 完整的 NPC 社交系统 (依据 `src/data/npcs.js`)
- [ ] **多结局系统**: 基于反脆弱程度的 8 种人生结局

## 📚 文档资源

- [REFACTORING_SUMMARY.md](./REFACTORING_SUMMARY.md): 详细的重构技术总结。
- [playability-improvements.md](./playability-improvements.md): 可玩性提升设计文档。
- [人生模拟器头脑风暴.md](./人生模拟器头脑风暴.md): 原始设计理念白皮书。

## 🤝 贡献与许可

欢迎提交 Issue 和 Pull Request。本项目采用 MIT 许可证。

---
*Created by Antigravity*
